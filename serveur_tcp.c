// programme client-serveur permettant de dialoguer// en echangeant des caracteres frappes au clavier#include<stdio.h>#include<sys/types.h>#include<sys/socket.h>#include<netinet/in.h>#include<netdb.h> //seulement utile pour client (gethostbyname)#define LEPORT 2345int taille, taille1, taille2, bd;struct sockaddr_in *padin; //pointeur d'adresse interne pour nommer socketint lg=80;char msg[80], msg1[80];char c;struct sockaddr *p_adr;int *p_lgadr;int nb;int sens=2;int V_listen;int V_accept;int V_write;int V_read;int V_shutdown;void main(){//1-creation d'un socketint s=0;s=socket(AF_INET, SOCK_STREAM, AF_UNSPEC);if (s==-1){	printf("Erreur de creation socket\n");	exit(-1);}printf("Le socket est identifie par : %d\n",s);//2-attachement d'un sockettaille=sizeof(struct sockaddr_in);padin=(struct sockaddr_in *) malloc(taille);bzero((char *)padin, taille);padin->sin_family = AF_INET;padin->sin_port = htons(LEPORT);bd=bind(s, (struct sockaddr *)padin,taille);if (bd==-1){	perror("Erreur d'attachment socket\n");	exit(-2);}printf("Le socket est attache\n");//3-programme serveurprintf("Je me mets en position d'ecoute!\n");nb=5;V_listen = listen(s,nb);if (V_listen==-1){	perror("Erreur d'ecoute\n");	exit(-3);}printf("J'ecoute!!...\n");p_lgadr=(int*)malloc(sizeof(struct sockaddr));V_accept=accept(s,p_adr,p_lgadr);if (V_accept==-1){	perror("Problème d'accord sur l'etablissement de connexion\n");	exit(-4);}printf("Connexion etabli. J'ai un CLIENT\n");while (1) {	V_read = read(V_accept,&c,1); 	if (V_read==-1)	{		perror("Problème de lecture\n");		exit(-4);	}	printf("%c\n",c);	c=getchar();	V_write=write(V_accept, &c, 1);	if (V_write==-1)	{		perror("Problème d'ecriture\n");		exit(-4);	}	printf("%c\n",c);} //fin whileV_shutdown=shutdown(s,sens);	if (V_shutdown==-1)	{		perror("Problème de fin de session\n");		exit(-4);	}close(s);}; //fin main()